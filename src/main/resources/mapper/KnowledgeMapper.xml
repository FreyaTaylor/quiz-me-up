<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.quizmeup.mapper.KnowledgeMapper">

    <!-- 查询所有叶节点知识点 -->
    <select id="selectAllLeafNodes" resultType="com.example.quizmeup.entity.Knowledge">
        SELECT id,
               parent_id,
               name,
               description,
               level,
               importance,
               is_leaf,
               created_at,
               updated_at
        FROM lc_knowledge
        WHERE is_leaf = TRUE
        ORDER BY created_at ASC
    </select>

    <!-- 查询所有一级知识点（根节点） -->
    <select id="selectRootNodes" resultType="com.example.quizmeup.entity.Knowledge">
        SELECT id,
               parent_id,
               name,
               description,
               level,
               importance,
               is_leaf,
               created_at,
               updated_at
        FROM lc_knowledge
        WHERE parent_id IS NULL OR parent_id = ''
        ORDER BY created_at ASC
    </select>

    <!-- 根据根节点ID查询该根节点下的所有叶节点 -->
    <select id="selectLeafNodesByRootId" resultType="com.example.quizmeup.entity.Knowledge">
        SELECT id,
               parent_id,
               name,
               description,
               level,
               importance,
               is_leaf,
               created_at,
               updated_at
        FROM lc_knowledge
        WHERE is_leaf = TRUE
          AND id LIKE CONCAT(#{rootId}, '%')
        ORDER BY created_at ASC
    </select>

</mapper>
